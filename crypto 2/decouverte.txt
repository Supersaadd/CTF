atelier :
interupteur norme IP55

YYZ : tourelle, fais gaffe quand t'allume

salle serveur :
POST-IT PASSWORD: ISECR0XX

Un bon vieux modèle 104 touches, AZERTY.  Conçu pour durer il y a 45 ans.
Sans surprise, il y a un post-it en dessous.  Il indique:
U2FsdGVkX1+wfkYH/uusQLu+f/aGJgjDOBe5xUEz+UaQV/WNS7t4E2omjtiHyq5N
SRM9xBSON0bWSuxv/C/AbA==

openssl enc -d -base64 -aes-128-cbc -pbkdf2 -pass pass:"ISECR0XX" -in txt
mdp obtenu : 04a7f71b-6228-490d-8084-bb79480c5556

administrateur:
username: quentin.de_magalhaes
password: 6ARkNJu7&F

openssl pkeyutl -encrypt -hexdump -pubin -inkey <fichier contenant la clef publique>

CSR :
openssl req -nodes -newkey rsa:2048 -sha256 -keyout myserver.key -out server.csr -utf8

lire Cambridge : https://m1.tme-crypto.fr/words

LPNHE

Un post-it rose collé sur la porte.  Il dit :
        cali13, combien de fois t'ai-je dit de ne pas choisir ton mot de passe
         dans le Cambridge English Dictionary ? Tu n'apprends jamais rien !
         Comment je suis censé faire respecter une politique de securité, moi, tu y penses ?
        ---
        L'administrateur système

Une feuille A4, 80g/m². Un utilisateur a imprimé dessus une trace du protocole 
d'authentification CHAP. Peut-être qu'il essayait de mettre au point un client
personnalisé pour se connecter ? Il y a écrit :
---> {"jsonrpc": "2.0", "method": "protagonist.CHAP-challenge", "params": {"world_id": "018cf51a32733d97cbed3bf34cac86b3", "username": "cali13"}, "id": 428}
<--- {"jsonrpc": "2.0", "result": "U2FsdGVkX198MH55kVSKzlQbUmAxZG80H/pb5JnyyiPOjX/BJFg+d/bPkHrBxYJX\n", "id": 428}
---> {"jsonrpc": "2.0", "method": "protagonist.CHAP-response", "params": {"world_id": "018cf51a32733d97cbed3bf34cac86b3", "response": "tapes tardy pumas small avast"}, "id": 429}
<--- {"jsonrpc": "2.0", "result": null, "id": 429}

1. Dans le cadre de notre campagne de communication intitulée
        "une sécurité maximale, mais avec la classe"
   nous vous rappelons que tous les utilisateurs de ce bâtiment
   doivent dorénavant avoir une clef publique RSA qui contient
   la chaîne "+++ATRIUM+++".

2. Cette chaîne promotionnelle doit se trouver à l'intérieur de la clef
   publique ; en particulier, elle ne doit pas être ajoutée au bout d'une
   clef pré-existante.  Autrement dit, ceci n'est pas autorisé :
       -----BEGIN PUBLIC KEY-----
       MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsHyqhsu3IxBYkCifvMrP
       uM/uv0hfq0PHbCfrUxFYooWLm3M0rru5Q+9BKQXqBRLa9iO+Tgn8Sy9+ABz0EJVd
       RRtatBkRj/UG3k+65UMxn5s47It+2sCXrX8TDmqPPtVa8Heo/5pqH1A/0LGj5YRo
       8GT0/ITj40j3I+Kp/1a9qP6+5eAqvUHfpC/hro2OCBAOi4+Q8qB+Zrx3jCa1l4R4
       0zQpvVf0nE+tjt7ZLBqlwKUnEWvVmFYJ3l/dikT9yG7s0UBOhAT8rZmwZVOluYeW
       yuERSus5TJbN8V9XR8q1lk8o7WBxtpyJotf5l/cCdmVlL9cSaZhVx26cAEcZ496z
       2QIDAQAB+++ATRIUM+++
       -----END PUBLIC KEY-----

3. Pour entrer dans le bâtiment ou dans les bureaux, il faut passer son
   badge devant le lecteur NFC.  Le badge doit contenir la clef publique,
   puis l'utilisateur doit réaliser une signature de manière interactive.

4. Pour simplifier la gestion des clefs, les occupants du même bureau 
   ont des clefs publiques RSA qui ont le même modulo (N).

afin d'entrer dans cicsu : openssl req -new -key private_key.pem -out certificate.csr -subj "/CN=quentin.de_magalhaes"
pour generer une requete de certificat puis signer avec terminal


foyer :
DIRECTOR's PUBLIC-KEY:
                    -----BEGIN PUBLIC KEY-----
                    MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvtbNyPFC1hhUtr3cb56z
                    a7v05dq3cgckAHgpPDhOtT1OOgsvJQ1t0RkkSJc7JQ1WNRchjJChLARH9bMd83QQ
                    2KLiFXPA8FqKqZJBFHCAU7CIeNO1PM01ujUWwCw2ktBIrUbpi3++E6mbRnD8yW3V
                    HnoEo9qTSTq1tbD/eud3CNdPjJZBElI/7VnBvclJv+okj/CjkoUwKwKSprjeI/mK
                    kgE1zxtWYOFutP3bsktDEu9cWfSgKmff8rKKbRsMPjlCwXNvqkOpTwmV4EvabIc6
                    HLr2aFQkGWq8YYXT5A/BzCdvrnLeBGXZdI5ut+FltigApT8sZ+RpPMkrN6nuS8RJ
                    6QIDAQAB
                    -----END PUBLIC KEY-----


fournissiez une signature (réalisée par le directeur du labo) de la chaîne de
caractères :

        "I, the lab director, hereby grant quentin.de_magalhaes permission to take the BiblioDrone-NG."

Ensuite, bien sûr, vous pourrez l'emprunter.


Atrium:

Le panneau en liège montre un message chiffré par les deux clefs publiques.
Ce serait sûrement utile de le déchiffrer.  Mais cette fois, aucune clef
secrète n'est opportunément disponible.


>>> conseil digicode
Ceci est cepdendant possible car les deux clefs publiques ont le même N.

>>> conseil digicode
La formule magique est : ``CRT dans les exposants''.

>>> conseil digicode
En clair, cherchez une relation de Bezout u*e1 + v*e2 == 1.

>>> conseil digicode
Après, vous avez c1 == m**e1 mod N et c2 == m**e2 mod N.  Par conséquent,
c1**u * c2**v == m**(u*e1 + v*e2) == m mod N.  Et boum.


>>> conseil digicode
Rappel : m**(-42) == (m**42)**(-1) == (m**(-1))**42 mod N

- jackieperez: 7e344e9ea474548854fa00eacf7981e085c4380f8cf10775b589671f5d1172787de87a19b53eac90de6ffd0f2b2ae3730ff5b83815e99752efb6c030d794234d97bcfac928dd7520f6c8f8eb94e7cbc446b98abc8414f0f79facc4935668bac70f32ddc1b61d9bf436c03abfe6539f7a5b2aa37a73d5c7e88a105225517bdd78be1413921e857e84ae80a227b85cd051f6560b7b4569c5de021edc36a055657e802827f44c82843776912d2c04617a5d43c38138a9b5f16f3585b0599576b6dbdab562537c1bdfb9d43cc75971c3021b8db354a72261badab5d103629d4b5537cb6d21045ca1f4f66ae39108c050753b151403d615d1ccb62ff959c135facd10
- emily26: 5cad9363628762f62f3cabaf4786f2f68b5bfa263783a1bfbb19e92cfa9ca442198e4d9bd91d355e6520f38c1953ae961ef0dc47136e09e81efc12e658e31241ea47b3cce8c4a1fea38365a24f6f98e17175ec36c4fce764f3894bc36714bebedf52d8302a9e0de8959ac60ec95ed5a92a0d6f3294410d406c87fa7177a1fc22315229191d2456cd179ecf70714c7baa5ea6234b1ab8e2395c187dc1b7d0aab2baaecb165d72c450a6ac98da8de02518393942250379a08f7efc982fdd279335afefd86eeaf61442bb19681637570ae22f89afd0bb19d02781fcd6e6edc1c7be3d268e27f44df02ff4fa89ab7ecfc7284416245e932e214ddad060a8d621bb31

jackieperez :
-----BEGIN PUBLIC KEY-----
MIIBPTANBgkqhkiG9w0BAQEFAAOCASoAMIIBJQKCAQEA4g7HfABU/SLmqu0uEW8+
kvfNG+1VCjNMeQoMgPmbOEPZI21/VsZCbtSTLhnYg5XkA8Xp4EteqRmluFUk/tQs
95xPTTlt9sL+mmvrVzD73y/tFIw3UCWs4yZIw9cEKd0QB0vEb1FD2yKaNWVaDaKr
CQ1+KpCYHaj/g+yD1m/CPU+fjvQmRrOWCV7cPlV5U0EhXW7LteZm8nzWbvjSk+UT
gNJ/q+qyvdo7KXGwc0beV2mU0NiwAfvewRoy+T0oPQpjof2wXyES6DKyoT1x1hW2
VLUNwaUN1xj+R2AVcu9X3jYdvfG2z3RadAJhJUQlzNbWFflFouyNFmqntc66xe/l
gQIeRyQfhMYdxkTjzElYi4dWpQAAAAA+++ATRIUM+++B
-----END PUBLIC KEY-----

emily26:
-----BEGIN PUBLIC KEY-----
MIIBPTANBgkqhkiG9w0BAQEFAAOCASoAMIIBJQKCAQEA4g7HfABU/SLmqu0uEW8+
kvfNG+1VCjNMeQoMgPmbOEPZI21/VsZCbtSTLhnYg5XkA8Xp4EteqRmluFUk/tQs
95xPTTlt9sL+mmvrVzD73y/tFIw3UCWs4yZIw9cEKd0QB0vEb1FD2yKaNWVaDaKr
CQ1+KpCYHaj/g+yD1m/CPU+fjvQmRrOWCV7cPlV5U0EhXW7LteZm8nzWbvjSk+UT
gNJ/q+qyvdo7KXGwc0beV2mU0NiwAfvewRoy+T0oPQpjof2wXyES6DKyoT1x1hW2
VLUNwaUN1xj+R2AVcu9X3jYdvfG2z3RadAJhJUQlzNbWFflFouyNFmqntc66xe/l
gQIeILmCOBaCo3/MXZRbbwVHwwAAAAA+++ATRIUM+++B
-----END PUBLIC KEY-----


username: steven62
d       :
8c4c89f9f3389b9ea0190390db0d834b9d84f84fc3ba559a523a28f1fbe01f264
b5c904330ad496d8fc3f18d591d7a10d1eac14bc62720f5baf0ac126ed99d5cad
96b6a43557bb3ffd56a4f34fb66046370ddb3f0b0eef77d3c2b5e62312c3ea036
bf6890d455ce681208acfb9a4e1cc2837683fa1e2dd952383fca74bc36c1e92ee
db296432224c03cf1be9f4e2430fba369017cafd530ba8194473987441e9b6967
4fa1024e824d19ad6f694eaf63e611963910f8a87717a1138bb8d9a8add25aba6
2edf54a9d83e3b68cab2bfbfc294c0341ccdfd367780387ef0d8f573afbafcbfc
49c028c48411f3b13b5a10aef316dc188124b9a8fe774764f3db20a41

la clé publique de steven62 : 
-----BEGIN PUBLIC KEY-----
MIIBPTANBgkqhkiG9w0BAQEFAAOCASoAMIIBJQKCAQEAwA5CG8MryvLTC9uzPsG4
scvMbjuN7Pg61wLi17tQI5+t7ow4aSQ6kQnEH6Is7yB/ndzw2UzxX0Y5cjb6uzvj
jpPqIQbPnuswGiCyluchxGFIaboTt/Bs1bjJ1xCF22fjFK8kYbvy7wHExQP8q77R
IXSOn3OIIsPBJl0hilh+OCCWVz2iHPWKr2qbX3BCvcLP9jEbzPzhGoygZFI4UniE
LWViJ61ENrqXx6zT3+6Mr9Jc4OTupoSH/oFv8kgIRdEeBKMjHGAPUu5VblFVFMst
rkbGgnajOZFVU60sW751PNZLS5OBB48Mus+g8EPUHU7hhsB1JNYHSMWnKlC/ePwM
DQIeNgitlJj9U9aHkWUJ+dXu9QAAAAA+++ATRIUM+++B
-----END PUBLIC KEY-----

>>> conseil nfc
Vous pouvez essayer avec la clef d perdue par un des deux occupants.  Si ça ne
marche pas, alors il vous faut réussir à vous faire passer pour l'AUTRE occupant.


>>> conseil nfc
Le ``mémento'' explique que les occupants du même bureau doivent avoir le même N.

>>> conseil nfc
Comme vous avez le d de l'un des deux, vous pouvez factoriser leur N commun.

>>> conseil nfc
(c'est dans les diapos du cours)

>>> conseil nfc
De là, vous pouvez obtenir le d de l'autre.

rsa.reduction:21:1|53698c6d11cb7db3eea849d27049212cb3a3fd2400b04ed5c47216bdb6f74845

firmware update key: 692e4ba7acd40ec8

chap.login:21:1|21adf8f447b0e2d418b384238cdf73a13515f6aa94918a2ed0bf81a81df09823

pk.login:21:1|0763ebeb1605cfdca0e10279e402c04bfcef2fbf4e0b67389a3d7b15b3d9d705

secure.vault:21:1|ed88e5aef504e805d044cd1bbe4c410306d26fc3082f73c168b4a3895a36ec44

rsa.crt:21:1|58401ec7855ba4157dec12b462c28a079ad6b7071ecccf9de0dda0d8f4b0db56

rsa.malleable:21:1|73085940d1bcbf5a8efa2b998579d0bcdc5515fe4a84f31d4df365aa63c06cb4

Firmware updated. New command activated: ``#!item-debug''.

hybrid:21:1|0052c9b38857506aa9082317c16bfe916927c54cde839d4d9ce94df7585b21a4

Firmware updated. New command activated: ``#!sudo''.

secret.sharing:21:1|7f783ec1916e1e0500bbec02b3c6911a193eece93aece875ed709c04a20d5288

Firmware updated. New command activated: ``#!bluetooth''.

credit.fraud:21:1|41164212dfc2d088e670f0daa1a7366a0442eec9e7caadc730003028b9b7a570

multi.lamport:21:1|a126cc02d5c91cd4eb92042c5860ea4a9fb85c50c784d1fb4e5941daebd4cf62

tme.pratt:21:1|e6a0ca292023f7e65ea2164662512f2066935fb21771cdc2771c2fd1f0e015fb

tme.squares:21:1|db96dd69bf2900248738fb7c18d69ccbaa11f41cf7bff2b5d6e6189b6dbc464b