import math
from decimal import Decimal


N_str = "00e5215031eb617e1fa9369d12ee69dba620a58c9401a598a8c9cbed3c160fb150c44d6fa27c113a3b30b5d353a3a6fc242499c6cbb22303185f07c879fc14740cd499ffbd5278a0fa8ee846f3d70122626679025fe6e1a339df9ce87e12b47200cdf9c2c83e1681be21bbecba98515676cfe3d571ddece5b47892018a95581f040528bdd9e60999f64afdf957c097be5d4e0dc3795700ae1b46c5446601fa93fe81b03d73ddf42b8b83d43f2978d5ed549d592584e5edab36a5e64c0ab3dc7d2ba9090f29e1bb9746d5ca813ce3bda8601ae327eab8a9ca236fe88a6637467ef53eedceaf69d509d8badadee0115db6f04ced55e2725ab0054cf902863f80fe4f"
N = int(N_str, 16)
    # 1. Stacy 
e1_str = "00cb005712c3e7f45cc873cfb89b053f010000000000003efbe01344850cfbef81"
e1 = int(e1_str, 16)
c_1_str = "29c7cc80b03f633570f7e9c6fb59bef74fd7174b0b0704d0569660fea708e71ab4b5068b9403c3245dfd96dbab8ea0fd9ad1c37c0e290e631657bcd51b66a30b6f2a7ce3b310d2760ae9c4014a470f8561e46876ceadf7e1e103cf80f8cb10e961a5ad1326a3ef6db0994d7783b967c92edd3f112690a9751feef0018219647be607f3d52828935c69a83af69bf4d84488829b95879a79c9d05a5f7f912abb4c8c53e53cd2f0fa5d3e88ea8169e4ecb60c9bddbd63a25e326e3a4481927dc3ada0da850c6847bf21bb591f1258604d0a73e51c2929c458f6fcdf58acc1203596a184e4b0ecbbb51e79f0152b94c6c02c279c46a9e5ac7188ca16f05456c28693"
c1 = int(c_1_str, 16)
    # 2. Julie
e2_str = "009a494362c3812460f34e2fd20cafd2050000000000003efbe01344850cfbef81"
e2 = int(e2_str, 16)
c_2_str = "143841af22299df6d3959779fb9f3ff5265a5d051c9eb293734338b6bea2287b74c0199437fc1d55b90c70b2ff79da3651f0119732131c0a52ff95d4f7774d50e75df53c07522e4c78e63c3b07c8b4a4a234265308da4bace4988a8710821c85e6cf251f55b67cbfece9ea16d25edbf6f87d6f03af6c0601e14c4001d81ae1f2bec70be3a255de1e543408474c61ef89ab02a19ae96744e89e201e8fdcc5f4c6184572e23477e0cd27b844c82a25dd518a401cbd8dfdf5c698831d68e446d3c7069a79975c9d47a5d57a7ac908dd8209f3a7501e5e71325c0feb9f7e809423db709ac6db71810386fa5a34e4bfd44be2d39adab4a94a4fe83723c95b2b07a861"
c2 =int(c_2_str, 16)


def extended_euclidean_algorithm(e1, e2):
    a, b, u1, u2, v1, v2 = e1, e2, 1, 0, 0, 1
    while b != 0:
        q, r = divmod(a, b)
        a, b = b, r
        u1, u2 = u2, u1 - q*u2
        v1, v2 = v2, v1 - q*v2
    return (u1, v1)

u, v = extended_euclidean_algorithm(e1, e2)

#print(u, v) 

# Compute the plaintext message
m = pow(c1, u, N) * pow(c2, v, N) % N

m.to_bytes(256,byteorder="big")

"Nouveau digicode de la salle RC-25 : 8d7cfe52d9c21fba1d8e7ff02abc38d2"